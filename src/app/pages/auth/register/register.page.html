<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/auth/login"></ion-back-button>
    </ion-buttons>
    <ion-title>Inscription</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="register-container">
    <div class="header-section">
      <h2>Créer un compte</h2>
      <p>Rejoignez Wevy et commencez à décider vos repas ensemble</p>
    </div>

    <form>
      <ion-list>
        <ion-item>
          <ion-input
            #nameInput
            type="text"
            placeholder="Prénom"
            label="Prénom"
            labelPlacement="floating"
          ></ion-input>
        </ion-item>

        <ion-item>
          <ion-input
            #emailInput
            type="email"
            placeholder="Email"
            label="Email"
            labelPlacement="floating"
          ></ion-input>
        </ion-item>

        <ion-item class="password-item">
          <ion-input
            #passwordInput
            [type]="showPassword ? 'text' : 'password'"
            placeholder="Mot de passe"
            label="Mot de passe"
            labelPlacement="floating"
          >
          </ion-input>
          <ion-icon 
            [name]="showPassword ? 'eye-off' : 'eye'"
            (click)="togglePasswordVisibility()"
            class="password-toggle"
          ></ion-icon>
        </ion-item>

        <ion-item class="password-item">
          <ion-input
            #confirmPasswordInput
            [type]="showConfirmPassword ? 'text' : 'password'"
            placeholder="Confirmer le mot de passe"
            label="Confirmer le mot de passe"
            labelPlacement="floating"
          >
          </ion-input>
          <ion-icon 
            [name]="showConfirmPassword ? 'eye-off' : 'eye'"
            (click)="toggleConfirmPasswordVisibility()"
            class="password-toggle"
          ></ion-icon>
        </ion-item>
      </ion-list>

      @if (error) {
        <ion-text color="danger">
          <p class="error-message">{{ error }}</p>
        </ion-text>
      }

      <ion-button
        expand="block"
        color="primary"
        (click)="register(nameInput, emailInput, passwordInput, confirmPasswordInput)"
        [disabled]="loading"
        class="register-button"
      >
        @if (loading) {
          <ion-spinner name="crescent"></ion-spinner>
        } @else {
          S'inscrire
        }
      </ion-button>

      <div class="login-link">
        <ion-text>
          <p>
            Déjà un compte ?
            <a routerLink="/auth/login">Se connecter</a>
          </p>
        </ion-text>
      </div>
    </form>
  </div>
</ion-content>
